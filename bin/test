#!/bin/bash

set -e

echo `go version`

SCRIPT_DIR=`dirname $0`
cd ${SCRIPT_DIR}/..

echo "Go formatting..."
go fmt ./...

echo "Go vetting..."
go vet ./...

echo "Go imports"
go get -v golang.org/x/tools/cmd/goimports
goimports -w .

go get -v github.com/onsi/ginkgo/ginkgo
go get -v github.com/onsi/gomega
go get -d -v -t ./...


echo "Recursive ginkgo... ${*:+(with parameter(s) }$*${*:+)}"
ginkgo -r --randomizeAllSpecs --failOnPending -cover $*
